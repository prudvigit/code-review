  // PIR Fixed Vendor Indicator Flag
  case
    when ( eord.flifn <> '' or eord.febel <> '' )
         and eina.infnr is not null and eine.infnr is not null
         and eina.lifnr = eord.lifnr
         and eine.werks = marc.werks
         and eina.matnr = mara.matnr
      then 'Y'  -- Fixed vendor and PIR exist

    when ( eord.flifn = '' and eord.febel = '' )
         and eina.infnr is not null and eine.infnr is not null
         and eina.lifnr = eord.lifnr
         and eine.werks = marc.werks
         and eina.matnr = mara.matnr
      then 'N'  -- PIR exists but no fixed vendor

    when ( eord.flifn = '' and eord.febel = '' )
         and ( eina.infnr is null or eine.infnr is null )
      then 'N'  -- PIR does not exist and no fixed vendor

    else ''
  end as PirFixedVendorFlag,
